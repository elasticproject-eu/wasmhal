// ELASTIC TEE HAL - Random Number Generation Interface
// Cryptographically secure RNG with hardware entropy

package elastic:random@0.1.0;

interface random {
  enum entropy-source {
    hardware,
    platform,
    userspace,
  }

  record entropy-info {
    source: entropy-source,
    quality: u32,
    available-bytes: u64,
  }

  get-random-bytes: func(length: u32) -> result<list<u8>, string>;
  get-secure-random: func(length: u32) -> result<list<u8>, string>;
  get-entropy-info: func() -> result<entropy-info, string>;
  reseed: func(additional-entropy: list<u8>) -> result<_, string>;
}

world random-world {
  export random;
}
